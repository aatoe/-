# 双向数据绑定

**双向数据绑定就是 页面 和 数据 无论哪一方发生改变，都可以改变当前的数据。**

#### 脏检查

> 说的是以前老版本的 Angularjs
>
> Angularjs内部会维护一个序列，将所有需要监控的属性放在这个序列中，当发生某些特定事件时（注意，这里并不是定时的而是由某些特殊事件触发的），Angularjs会调用 $digest 方法，这个方法内部做的逻辑就是遍历所有的watcher），对被监控的属性做对比，对比其在方法调用前后属性值有没有发生变化，如果发生变化，则调用对应的handler。

#### 观察机制（Object.observe()）

> 下面这一段来自MDN https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/observe
>
>  **已废弃**
> This feature is obsolete. Although it may still work in some browsers, its use is discouraged since it could be removed at any time. Try to avoid using it.
>
> **`Object.observe()`** 方法用于异步地监视一个对象的修改。当对象属性被修改时，方法的回调函数会提供一个有序的修改流。然而，这个接口已经被废弃并从各浏览器中移除。你可以使用更通用的 [`Proxy`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy) 对象替代。

#### 封装属性访问器

> vue.js实现数据双向绑定的原理就是属性访问器
>
> 使用了Object.defineProperty 方法，现在的vue3.0已经使用了 Proxy

本文将会使用 Object.defineProperty   proxy进行不同的数据双向绑定





##  Object.defineProperty()

```js
html
 <input type="text" id="userName" />
 <span id="uName">暂时没有数据</span>
 get：<span id="getName">点击触发get 方法</span>

js:
let obj = {
      userName: "",
};
Object.defineProperty(obj, "userName", {
      // 注意 数据描述符	configurable	enumerable	value	writable
      // 存取描述符  	configurable	enumerable	get	set
      configurable: true, //能否使用delete、能否需改属性特性、或能否修改访问器属性、，false为不可重新定义，默认值为true
      enumerable: true, //对象属性是否可通过for-in循环，flase为不可循环，默认值为true
      // writable: true, //对象属性是否可修改,flase为不可修改，默认值为true
      // value: "Atoe", //对象属性的默认值，默认值为undefined
      get: function () {
        console.log("get init");
        return "固定值";
      },
      set: function (val) {
        console.log("set init", val);
        document.getElementById("uName").innerText = val;
        document.getElementById("userName").value = val;
      },
    });
    document
      .getElementById("userName")
      .addEventListener("keyup", function (event) {
        obj.userName = event.target.value;
      });
    document
      .getElementById("getName")
      .addEventListener("click", function (event) {
        console.log(obj);
        document.getElementById("uName").innerText = obj.userName;
      });
```

